<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" type="text/css" href="style.css">
    <title>CSC 515 Project</title>
</head>

<body>
    <p id="Heading">Registration Form</p>

    <!-- To open in xampp, type localhost/Form.html into browser -->
    <form action="" method="post">
        <label for="fname">First Name:</label>
        <br>
        <input type="text" id="fname" name="fname" placeholder="Enter your first name">
        <div id="resultFName"></div>
        <label for="lname">Last Name:</label>
        <br>
        <input type="text" id="lname" name="lname" placeholder="Enter your last name">
        <div id="resultLName"></div>
        <label for="email">Email:</label>
        <br>
        <input type="text" id="email" name="email" placeholder="Enter your Email">
        <div id="resultEmail"></div>
        <label for="mobile">Mobile:</label>
        <br>
        <input type="tel" id="mobile" name="mobile" minLength="9" maxlength="10">
        <div id="resultMobile"></div>
        <label for="gender">Gender:</label>
        <br>
        <fieldset id="gender" class="gender">
            <input type="radio" id="male" value="male" name="gender">Male
            <input type="radio" id="female" value="female" name="gender">Female
        </fieldset>
        <div id="resultGender"></div>
        <label for="city">City:</label>
        <br>
        <input type="text" id="city" name="city">
        <div id="resultCity"></div>
        <label for="state">State:</label>
        <br>
        <input type="text" id="state" name="state">
        <div id="resultState"></div>
        <label for="qualif">Qualification:</label>
        <br>
        <select id="qualif" name="qualif">
            <option value="select" disabled selected>Select Qualification:</option>
            <option value="graduation">Graduation</option>
            <option value="BTech">BTech</option>
            <option value="MTech">MTech</option>
            <option value="mca">MCA</option>
            <option value="bca">BCA</option>
        </select>
        <div id="resultQual"></div>
        <label for="pword">Password:</label>
        <br>
        <input type="password" id="pword" name="pword">
        <div id="resultPass"></div>
        <input type="submit" value="Submit">
    </form>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("form").submit(function () {
                //variable declarations
                var valid = true
                var first = $('#fname').val();
                var last = $('#lname').val();
                var mail = $('#email').val();
                var number = $('#mobile').val();
                var gen1 = $("#male");
                var gen2 = $("#female");
                var location = $('#city').val();
                var state = $('#state').val();
                var pass = $('#pword').val();
                var nameRegex = /^[a-zA-Z'\s]{1,30}$/;
                var emailRegex = /^(?!.{41})[a-z0-9]+(?:\.[a-z0-9]+)*@[a-z0-9-]+(?:\.[a-z0-9-]+)*\.[a-zA-Z]{2,6}$/;
                var mobileRegex = /^(?=.*\d)/;
                var locationRegex = /^[a-zA-Z]/;
                var passRegex = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]){3,10}/;

                if (!nameRegex.test(first)) {
                    $('#resultFName').html("");
                    $('#resultFName').html("<p style='color:red'>Error</p>");
                    valid = false;
                }
                else {
                    $('#resultFName').html("");
                    $('#resultFName').html("<p style='color:green'>Correct</p>");
                }

                if (!nameRegex.test(last)) {
                    $('#resultLName').html("");
                    $('#resultLName').html("<p style='color:red'>Error</p>");
                    valid = false;
                }
                else {
                    $('#resultLName').html("");
                    $('#resultLName').html("<p style='color:green'>Correct</p>");
                }

                //update regex to limit to two domains
                if (!emailRegex.test(mail)) {
                    $('#resultEmail').html("");
                    $('#resultEmail').html("<p style='color:red'>Error</p>");
                    valid = false;
                }
                else {
                    $('#resultEmail').html("");
                    $('#resultEmail').html("<p style='color:green'>Correct</p>");
                }

                if (!mobileRegex.test(number)) {
                    $('#resultMobile').html("");
                    $('#resultMobile').html("<p style='color:red'>Error</p>");
                    valid = false;
                }
                else {
                    $('#resultMobile').html("");
                    $('#resultMobile').html("<p style='color:green'>Correct</p>");
                }

                if (!gen1.prop("checked")) {
                    if (!gen2.prop("checked")) {
                        $('#resultGender').html("");
                        $('#resultGender').html("<p style='color:red'>Error</p>");
                        valid = false;
                    }

                    if (gen2.prop("checked")) {
                        $('#resultGender').html("");
                        $('#resultGender').html("<p style='color:green'>Correct</p>");
                    }
                }
                else {
                    $('#resultGender').html("");
                    $('#resultGender').html("<p style='color:green'>Correct</p>");
                }

                if (!locationRegex.test(location)) {
                    $('#resultCity').html("");
                    $('#resultCity').html("<p style='color:red'>Error</p>");
                    valid = false;
                }
                else {
                    $('#resultCity').html("");
                    $('#resultCity').html("<p style='color:green'>Correct</p>");
                }

                if (!locationRegex.test(state)) {
                    $('#resultState').html("");
                    $('#resultState').html("<p style='color:red'>Error</p>");
                    valid = false;
                }
                else {
                    $('#resultState').html("");
                    $('#resultState').html("<p style='color:green'>Correct</p>");
                }

                if ($("#qualif").prop('selectedIndex') == 0) {
                    $('#resultQual').html("");
                    $('#resultQual').html("<p style='color:red'>Error</p>");
                    valid = false;
                }
                else {
                    $('#resultQual').html("");
                    $('#resultQual').html("<p style='color:green'>Correct</p>");
                }

                if (!passRegex.test(pass)) {
                    $('#resultPass').html("");
                    $('#resultPass').html("<p style='color:red'>Error</p>");
                    valid = false;
                }
                else {
                    $('#resultPass').html("");
                    $('#resultPass').html("<p style='color:green'>Correct</p>");
                }

                if (valid == false) {
                    return false;
                }
                else {
                    //Grab values of radio button and selected option
                    var selGen = $("input[name='gender']:checked").val();
                    var selQual = $("#qualif").find(":selected").val();

                    $.post("sub_page.php",
                        {
                            name: first,
                            last: last,
                            email: mail,
                            number: number,
                            gender: selGen,
                            city: location,
                            state: state,
                            qualif: selQual,
                            passW: pass
                        },
                        function (status) {
                            alert("Status: " + status);
                        });
                }
            });
        });
    </script>
</body>

</html>